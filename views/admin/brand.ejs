<!DOCTYPE html>
<html>
<head>
<title>NYRAH Admin â€“ Brands</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
<style>
    body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background: #fde0e9;
}
    .container { width: 90%; margin: 30px auto; }
    table { width: 100%; background: white; border-collapse: collapse; margin-top: 20px; }
    table th, table td { padding: 12px; border-bottom: 1px solid #ccc; }
    button { padding: 7px 12px; cursor: pointer; }
    #modal { display:none; position:fixed; top:0; left:0; right:0; bottom:0; 
             background:rgba(0,0,0,0.5); align-items:center; justify-content:center; }
    #modal .box { background:white; padding:25px; width:350px; border-radius:6px; }
     .container {
    display: flex;
    min-height: 100vh;
}

/* ---------- SIDEBAR ---------- */
.sidebar {
    width: 240px;
    background: #ffffff;
    padding: 20px 15px;
    box-shadow: 2px 0 10px rgba(0,0,0,0.1);
    position: fixed;
    height: 100vh;
}

.brand {
    font-size: 26px;
    font-weight: bold;
    text-align: center;
    margin-bottom: 20px;
}
.header-bar {
      background-color: #ffd6e0; /* light pink */
      padding: 15px 20px;
      border-radius: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }

    .header-bar h2 {
      margin: 0;
      font-size: 24px;
      color: #d81b60;
    }

    .header-bar button {
      background-color: #d81b60;
      color: #fff;
      border: none;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .header-bar button:hover {
      background-color: #b71c4f;
    }

    /* Table */
    table {
      width: 100%;
      background: white;
      border-collapse: collapse;
      margin-top: 0;
    }
    table th, table td {
      padding: 12px;
      border-bottom: 1px solid #ccc;
    }
    table img { border-radius: 4px; }

    /* Modal */
    #modal {
      display: none;
      position: fixed;
      top: 0; left: 0; right:0; bottom:0;
      background: rgba(0,0,0,0.5);
      align-items: center;
      justify-content: center;
    }
    #modal .box {
      background: #fff;
      padding: 25px;
      width: 350px;
      border-radius: 6px;
    }
.menu {
    list-style: none;
    padding: 0;
    margin: 0;
}

.menu li {
    margin-bottom: 8px;
}

.menu li a {
    text-decoration: none;      
    color: black;              
    display: flex;              
    align-items: center;
    gap: 10px;                
    padding: 12px 15px;
    border-radius: 8px;
    font-size: 15px;
    transition: all 0.2s;
}


.menu li a:hover {
    background: #fce4ec;
    color: #d81b60;
}

.menu li.active a {
    background: #fce4ec;
    color: #d81b60;
}

.main {
    margin-left: 260px;
    padding: 20px;
    width: calc(100% - 260px);
    flex: 1;
    min-width: 0;
    position: relative; 
}

.section-title {
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 18px;
}

.main-profile-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    display: flex;
    align-items: center;
    gap: 6px;
    background: #fff;
    padding: 4px 8px;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    cursor: pointer;
}

.main-profile-btn .profile-img {
    width: 35px;
    height: 35px;
    border-radius: 50%;
    object-fit: cover;
    border: 1px solid #ccc;
}

.main-profile-btn .profile-name {
    font-size: 12px;
    font-weight: bold;
    color: #333;
}

.profile-menu {
    display: none; 
    
    position: absolute;
    top: 45px;
    right: 0;
    background: #fff;
    border-radius: 6px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    flex-direction: column;
    min-width: 120px;
    z-index: 10;
}

.profile-menu a {
    padding: 8px 12px;
    display: block;
    text-decoration: none;
    color: #333;
    font-size: 13px;
}

.profile-menu a:hover {
    background: #f0f0f0;
}

</style>
</head>

<body>

<div class="container">
    <div class="container">

    <aside class="sidebar">
    <h1 class="brand">NYRAH</h1>
    <ul class="menu">
        <li class="active"><a href="#"><i class="bi bi-speedometer2"></i> Dashboard</a></li>
        <li><a href="#"><i class="bi bi-bag"></i> Order</a></li>
        <li><a href="#"><i class="bi bi-box-seam"></i> Products</a></li>
        <li><a href="#"><i class="bi bi-graph-up"></i> Sales report</a></li>
        <li><a href="/admin/customers"><i class="bi bi-people"></i> Customer</a></li>
        <li><a href="/admin/category"><i class="bi bi-tags"></i> Category</a></li>
        <li><a href="#"><i class="bi bi-percent"></i> Coupon</a></li>
        <li><a href="#"><i class="bi bi-arrow-repeat"></i> Refund</a></li>
        <li><a href="#"><i class="bi bi-image"></i> Banners</a></li>
        <li><a href="#"><i class="bi bi-box-arrow-right"></i> Sign Out</a></li>
    </ul>
</aside>

    
  <div class="main">
  <div class="header-bar">
    <h2>Brands</h2>
    <button onclick="openModal()">+ Add Brand</button>
  </div>

  <table>
    <thead>
      <tr>
        <th>Brand</th>
        <th>Image</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% brands.forEach(b => { %>
        <tr>
          <td><%= b.brandName %></td>
          <td>
            <% if(b.brandImage){ %>
              <img src="/uploads/<%= b.brandImage %>" width="60">
            <% } else { %> No image <% } %>
          </td>
          <td><%= b.isBlocked ? "Blocked" : "Active" %></td>
          <td>
            <button onclick="editBrand('<%= b._id %>', '<%= b.brandName %>')">Edit</button>
            <button onclick="deleteBrand('<%= b._id %>')">Delete</button>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>

<div id="modal">
  <div class="box">
    <h3 id="modalTitle">Add Brand</h3>
    <input type="hidden" id="editId" name="id">
    <input type="text" id="brandName" name="brandName" placeholder="Brand Name"><br><br>
    <input type="file" id="brandImage" name="brandImage"><br><br>
    <button onclick="saveBrand()">Save</button>
    <button onclick="closeModal()">Cancel</button>
  </div>
</div>

<script>
function openModal() {
    document.getElementById("modal").style.display = "flex";
    document.getElementById("modalTitle").innerText = "Add Brand";
    document.getElementById("editId").value = "";
    document.getElementById("brandName").value = "";
}

function editBrand(id, name) {
    document.getElementById("modal").style.display = "flex";
    document.getElementById("modalTitle").innerText = "Edit Brand";
    document.getElementById("editId").value = id;
    document.getElementById("brandName").value = name;
}

function closeModal() {
    document.getElementById("modal").style.display = "none";
}

async function saveBrand() {
    const id = document.getElementById("editId").value;
    const brandName = document.getElementById("brandName").value;
    const brandImage = document.getElementById("brandImage").files[0];

    if (!brandName) { alert("Brand name required"); return; }

    const formData = new FormData();
    formData.append("brandName", brandName);
    if (brandImage) formData.append("brandImage", brandImage);
    if (id) formData.append("id", id);

    const url = id ? "/admin/brand/edit" : "/admin/brand/add";

    const res = await fetch(url, { method: "POST", body: formData });
    const data = await res.json();
    alert(data.msg || "Success");
    location.reload();
}

async function deleteBrand(id) {
    if (!confirm("Delete?")) return;

    await fetch("/admin/brand/delete", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ id })
    });

    location.reload();
}
</script>
</body>
</html>